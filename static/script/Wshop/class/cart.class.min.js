define([], function() {
	var storage = window.localStorage;
	var _o = {
		cart : {},
		init : function() {
			var _d = storage.getItem("cart");
			if (_d) {
				this.cart = eval("(" + storage.getItem("cart") + ")")
			} else {
				this.cart = {}
			}
		},
		add : function(productId, count, priceHashId) {
			eval("var ext = this.cart.p" + productId + "m" + priceHashId);
			var cmd = ext ? " +=" : " =";
			eval("this.cart.p" + productId + "m" + priceHashId + cmd + count);
			this.save()
		},
		del : function(productId, priceHashId) {
			eval("delete this.cart.p" + productId + "m" + priceHashId);
			this.save()
		},
		count : function() {
			var c = 0;
			for ( var k in this.cart) {
				c += this.cart[k]
			}
			return c
		},
		clear : function() {
			this.cart = {};
			storage.setItem("cart", "{}");
			storage.removeItem("tmporder");
			storage.removeItem("carthash")
		},
		save : function() {
			storage.setItem("cart", JSON.stringify(this.cart))
		},
		set : function(mhash, count) {
			eval("this.cart." + mhash + "=" + count);
			this.save()
		}
	};
	_o.init();
	return _o
});