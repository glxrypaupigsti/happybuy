var suload=false;var storage=window.localStorage;var shopdomain="http://112.124.44.172/wshop/";var shoproot="/wshop/";var shareDesc="专注母婴行业7年";var isSupportTouch="ontouchend" in document?true:false;var plistShowType="hoz";var priceHashId=0;var Spinner=new Spinner({lines:11,length:7,width:2,radius:9,corners:0.9,rotate:0,direction:1,color:"#44b549",speed:1.2,trail:25,shadow:false,hwaccel:true,className:"spinner",zIndex:2000000000,top:"auto",left:"auto"});$(function(){resize();window.onresize=resize;if($("#slider").length>0&&$(".slider").length>1){window.currentTab=0;$("#slider").bind({"touchstart mousedown":function(event){if(event.originalEvent.touches){event=event.originalEvent.touches[0]}window.touchStartX=event.clientX;window.touchStartY=event.clientY;window.touchStartOffsetX=parseInt($(".slider").eq(0).css("marginLeft"));window.touchEndOffsetX=0;window.touchTabLength=$(".slider").length-1},"touchmove mousemove":function(event){if(window.touchStartX&&window.touchStartY){event.preventDefault();if(event.originalEvent.touches){event=event.originalEvent.touches[0]}touchX=event.clientX;touchY=event.clientY;touchEndOffsetX=touchStartOffsetX-(touchStartX-touchX);$(".slider").eq(0).css("marginLeft",touchEndOffsetX+"px")}},"touchend touchcancel mouseup":function(event){if(Math.abs(touchX-touchStartX)<10){goSlider(0)}else{var right=(touchX-touchStartX)>0;goSlider(right)}touchStartY=null;touchStartX=null}})}var touchStarget=null;$("[data-swclass]").each(function(index,node){var swclass=$(node).attr("data-swclass");var link=$(node).attr("data-link");$(node).bind({"touchstart mousedown":function(event){if(event.originalEvent.touches){event=event.originalEvent.touches[0]}$(node).addClass(swclass);touchStarget=event.target},"touchend mouseup":function(event){$(node).removeClass(swclass);if(event.originalEvent.touches){event=event.originalEvent.touches[0]}if(event.target===touchStarget){if(link){if(/javascript/.test(link)){link=link.replace("javascript:","");eval(link)}else{location.href=link}}}event.preventDefault()}})});$(".search-w-input").on("focus",function(){$(this).val("")});$(".productCountMinus").bind({"touchend touchcancel mouseup":function(event){event.preventDefault();var node=$(this).parent().find(".productCountNumi");node.val(parseInt(node.val())===1?1:node.val()-1)}});$(".productCountPlus").bind({"touchend touchcancel mouseup":function(event){event.preventDefault();var node=$(this).parent().find(".productCountNumi");node.val(parseInt(node.val())+1)}});$("#plistDp").click(function(){if(plistShowType==="hoz"){plistShowType=""}else{plistShowType="hoz"}$(".productListWrap").toggleClass("hoz");$(".serialCaption").toggleClass("hoz");$(this).toggleClass("h");$(".productList .photo").each(function(){$(this).height($(this).width());$(this).parent().toggleClass("clearfix")});$(".productList .title").each(function(){$(this).toggleClass("Elipsis")})});fnTouchEndRedirect("a")});function resize(){$(".nav-round").each(function(){$(this).height($(this).width())});$(".sliderTip").each(function(){$(this).css("left",($(this).parent().width()-this.clientWidth)/2)});var a=$(".productIW").width();$(".productIW").height(a)}function goSlider(c){c=c===0?0:(c===true?-1:1);currentTab+=c;currentTab=currentTab<0?0:currentTab>touchTabLength?touchTabLength:currentTab;var b=$(".slider").eq(0).width();var a=-currentTab*b;$(".slider").eq(0).animate({marginLeft:a+"px"});$(".sliderTipItems.current").removeClass("current");$(".sliderTipItems").eq(currentTab).addClass("current")}Object.onew=function(b){var a=function(c){};a.prototype=b;return new a};var Processing=Object.onew({start:function(){var a=$("<div class='processing'></div>");a.css({top:(($(body).height()-a.height())/2),left:(($(body).width()-a.width())/2)});$("body").append("<div class='processing'></div>")},finish:function(){$(".processing").remove()}});var Loading=Object.onew({start:function(b,a){if(!a){if($(b).attr("data-minheight")){$(b).css("min-height",$(b).attr("data-minheight"))}else{$(b).css("min-height","150px")}}Spinner.spin($(b).get(0))},finish:function(b,a){if(!a){$(b).css("min-height","0")}Spinner.spin().stop()}});var Tiping=Object.onew({flas:function(d){var b=120;var a=110;var c=$("<div class='_Tiping'>"+d+"</div>");$("body").append(c);c.css({left:($(window).width()-b)/2,top:($(window).height()-a)/2,width:b,height:a,lineHeight:a+60+"px"});$("._Tiping").fadeOut(3000,function(){$("._Tiping").remove()})}});var Cart=Object.onew({cart:{},init:function(){var _d=storage.getItem("cart");if(_d){this.cart=eval("("+storage.getItem("cart")+")")}else{this.cart={}}},add:function(productId,count,priceHashId){eval("var ext = this.cart.p"+productId+"m"+priceHashId);var cmd=ext?" +=":" =";eval("this.cart.p"+productId+"m"+priceHashId+cmd+count);this.save()},del:function(productId,priceHashId){eval("delete this.cart.p"+productId+"m"+priceHashId);this.save()},clear:function(){this.cart={};storage.setItem("cart","{}");storage.removeItem("tmporder");storage.removeItem("carthash")},save:function(){storage.setItem("cart",$.toJSON(this.cart))},set:function(mhash,count){eval("this.cart."+mhash+"="+count);this.save()}});Cart.init();var Orders=Object.onew({confirmExpress:function(a){a=parseInt(a);if(a>0){if(confirm("你确认收到货品了吗?")){$.post("?/Order/confirmExpress",{orderId:a},function(b){b=parseInt(b);if(b>0){$("#orderitem"+a).slideUp();if($("#expresscode")){window.location.reload()}}else{alert("确认收货失败！");bugNotify("确认收货失败！")}})}}},cancelOrder:function(a,b){a=parseInt(a);if(a>0){if(confirm("你确认要取消订单吗?")){$.post("?/Order/cancelOrder",{orderId:a},function(c){if(c==="1"){$(b).parent().parent().slideUp()}else{alert("订单取消失败！");bugNotify(a+"订单取消失败！服务器返回"+c)}})}}},wepay:function(a){a=parseInt(a);if(a>0){}},comment:function(a){a=parseInt(a);if(a>0){}}});function addContact(){}function loadProductList(b){if(!loadingLock){var c=$("#searchBox").val();var a="?/vProduct/ajaxProductList/page="+parseInt(b)+"&searchKey="+encodeURI(c)+"&cat="+$("#cat").val()+"&orderby="+$("#orderby").val()+"&stype="+plistShowType+"&serial="+$("#serial").val()+"&level="+$("#level").val();listLoading=true;$(".emptyTip").html("");$("#buttomLoading").show();$.get(a,function(d){$("#buttomLoading").hide();if(d==="0"&&c===""){if(!suload){$("#product_list").removeClass("clearfix").append('<div class="emptyTip">暂无数据</div>')}else{}loadingLock=true}else{if(d!=="0"){suload=true;d=$(d);var e=$(".patch",d);e.parent().addClass("rm");$("#product_list .pdBlock").last().append(e);$("#product_list").append(d);$(".rm").remove();$(".productIW").height($(".productIW").width());$(".productList .photo").each(function(){$(this).height($(this).width())})}}listLoading=false;c=null;a=null})}}function addToCart(c){var a=parseInt($("#iproductId").val());var b=parseInt($(".productCountNumi").eq(0).val());Cart.add(a,b,priceHashId);Tiping.flas("已加入购物车");if(c){location="wxpay.php"}}function searchdo(b){var a=$("input[type=search]",b);if(a.val()===""){return}var c=a.attr("targ");c=encodeURI(c+"&searchkey="+a.val());window.location.href="http://"+document.domain+(window.location.port?":"+window.location.port:"")+window.location.pathname+"?/"+c}function UchomeLoad(){}function CartCount(c){var b=0;for(var a in c){b+=c[a]}return b}function ExpressDetailOnload(){Loading.start("#loading-wrap",200);$.post("?/Order/ajaxGetExpressDetails",{com:$("#expresscom").val(),nu:$("#expresscode").val()},function(a){a=a.replace(/\d{4}-0?/g,"");$("#express-dt").html(a);$("#loading-wrap").remove();Loading.finish()})}function viewproductOnload1(){var a=new Image();a.src="static/images/icon/iconfont-roundcheck.png";var e=document.body.clientWidth;$(".sliderLoading").height(e);Spinner.spin($(".sliderLoading").get(0));$("#sliderX img").bind("error",function(){$(this).remove()});touchTabLength=$(".sliderX").length-1;$(".sliderX").width(e);if($("#slider")&&touchTabLength>=1){$("#slider,.sliderX").height(e).width(e);$(".sliderX img").each(function(){$(this).css({width:e});$(this).on("load",function(){$(this).css({marginTop:((e-$(this).height())/2)+"px"});$(".sliderLoading").hide();Spinner.stop()});if($(this).height()>0){$(this).css({marginTop:((e-$(this).height())/2)+"px"});$(".sliderLoading").hide();Spinner.stop()}});currentTab=0;touchStartOffsetX=0;touchStartX=false;touchStartY=false;slideNode=$(".sliderX:eq(0)");$("#slider").bind({"touchstart mousedown":function(f){if(f.originalEvent.touches){f=f.originalEvent.touches[0]}touchStartX=f.clientX;touchStartY=f.clientY;touchEndOffsetX=0},"touchmove mousemove":function(f){if(touchStartX&&touchStartY){f.preventDefault();if(f.originalEvent.touches){f=f.originalEvent.touches[0]}touchX=f.clientX;touchY=f.clientY;touchEndOffsetX=touchStartOffsetX-(touchStartX-touchX)*0.9;slideNode.css("marginLeft",touchEndOffsetX+"px")}},"touchend touchcancel mouseup":function(f){d(Math.abs(touchX-touchStartX)>=e*0.4?(touchX-touchStartX)>0:0);touchStartX=false;touchStartY=false;f.stopPropagation()}})}function d(f){f=f===0?0:(f===true?-1:1);currentTab+=f;currentTab=currentTab<0?0:currentTab>touchTabLength?touchTabLength:currentTab;touchStartOffsetX=-currentTab*(e);slideNode.animate({marginLeft:touchStartOffsetX},250);$(".sliderTipItems.current").removeClass("current");$(".sliderTipItems").eq(currentTab).addClass("current")}$("#pd-dsc1 .pd-spec-sx").on("click",function(){$("#pd-dsc2 .pd-spec-sx.hover").removeClass("hover");$("#pd-dsc2 .pd-spec-sx.enable").removeClass("enable");$("#pd-dsc1 .pd-spec-sx.hover").removeClass("hover");detId=$(this).attr("data-det-id");var f=c(detId);$(this).addClass("hover");if($("#pd-dsc2").length===0){b(detId,0)}else{$.each(f,function(g,h){$("#pd-dsc2 .pd-spec-sx[data-det-id="+h+"]").addClass("enable")});$("#pd-dsc2 .pd-spec-sx.enable").eq(0).click()}});$("#pd-dsc2 .pd-spec-sx").on("click",function(){if($(this).hasClass("enable")){var f=$(this).attr("data-det-id");$("#pd-dsc2 .pd-spec-sx.hover").removeClass("hover");$(this).addClass("hover");b(detId,f)}});function b(g,f){var h=$(".spec-hashs[value="+g+"-"+f+"]");$("#pd-sale-price").html("&yen;"+h.attr("data-price"));priceHashId=parseInt(h.attr("data-id"));h=null}$("#pd-dsc1 .pd-spec-sx").eq(0).click();function c(h){var g=[];var f=$(".spec-hashs[value^="+h+"-]");f.each(function(){g.push(parseInt($(this).val().replace(h+"-","")))});return g}$(".uc-add-like").click(function(){var g=$(this);var f=parseInt($("#iproductId").val());if(g.hasClass("fill")){f=(-1)*f}$.post(shoproot+"?/Uc/ajaxAlterProductLike/",{id:f},function(h){if(h>0){if(!g.hasClass("fill")){Tiping.flas("收藏成功")}g.toggleClass("fill")}})})}function viewproductOnload(){var a=$.cookie("comid");var c=parseInt($("#iproductId").val());var e=$("#shareimg").val();var d=shopdomain+"?/vProduct/view/id="+c+"&showwxpaytitle=1"+(a&&a!==""?"&com="+a:"");var b=$("#sharetitle").val();WeixinJSBridge.on("menu:share:timeline",function(f){WeixinJSBridge.invoke("shareTimeline",{img_url:e,img_width:"300",img_height:"300",link:d,desc:shareDesc,title:b},function(){pvShareCallback(c,a)})});WeixinJSBridge.on("menu:share:appmessage",function(f){WeixinJSBridge.invoke("sendAppMessage",{appid:$.cookie("appid"),img_url:e,img_width:"300",img_height:"300",link:d,desc:shareDesc,title:b},function(){pvShareCallback(c,a)})});WeixinJSBridge.on("menu:share:weibo",function(f){WeixinJSBridge.invoke("shareWeibo",{content:shareDesc,url:d},function(){pvShareCallback(c,a)})});WeixinJSBridge.call("showOptionMenu")}function pvShareCallback(b,a){$.post(shoproot+"?/Company/addComSpread/",{productId:b,comId:a},function(c){})}function homeOnload(){$(".subcat_item").each(function(a,b){$(b).css({height:$(b).width()+25+"px"})})}function pvListOnload(){loadingLock=false;if($("#product_list").length>0&&$("#orderDetailsWrapper").length!==1){window.pdPageNo=0;window.listLoading=false;loadProductList(pdPageNo);$(window).scroll(function(){totalheight=parseFloat($(window).height())+parseFloat($(window).scrollTop())+150;if($(document).height()<=totalheight&&!listLoading){loadProductList(++pdPageNo)}})}$(".subnav").click(function(){loadingLock=false;var a=$(this).attr("orderby");$(".active").removeClass("active");window.pdPageNo=0;var b=$(this).find("b._priceB");$(this).addClass("active");$(this).find("b._priceB").toggleClass("up");if(b.length!==0){a+=b.hasClass("up")?" DESC":" ASC"}else{a+=" DESC"}$("#orderby").val(a);$("#product_list").html("");if(!window.dontload){loadProductList(0)}window.dontload=false});window.dontload=true;if($("#orderby").val()==="`sale_count`"){}else{$(".subnav").eq(0).click()}}function bugNotify(a){$.post("?/Notify/notifyBug",{message:a},function(){})}function spreadListOnload(){window.spreadListPage=0;ajaxLoadSpreadList(spreadListPage);$(window).scroll(function(){ajaxLoadSpreadList(++spreadListPage)})}function ajaxLoadSpreadList(b){var a="?/Uc/ajaxSpreadList/page="+b;Loading.start("#loading-wrap");$.get(a,function(c){Loading.finish();$("#uc-spreadlist").append(c)});a=null}function debug(a){console.log(a)}function hGoback(){if(window.history.length>0){window.history.go(-1)}else{window.href=shoproot}}function hGohome(){window.location.href=shoproot}function catListOnload(){$(".footer").hide();serial_id=$("#serial_id").val();cat=$("#cat").val()>0?$("#cat").val():$(".viewCatTopItem").eq(0).attr("data-catid");fnTouchEnd(".viewCatTopItem",function(c){if(cat!==$(this).attr("data-catid")){cat=$(this).attr("data-catid");b(cat,serial_id);$(".viewCatTopItem.hover").removeClass("hover");$(this).addClass("hover");c.stopPropagation()}});$('.viewCatTopItem[data-catid="'+cat+'"]').eq(0).addClass("hover");b(cat,serial_id);$(".subcat_item").each(function(){$(this).css({height:$(this).width()+25+"px"})});function b(c){$("#viewCatRight").append('<div id="whiteWrap"></div>');Loading.start("#whiteWrap",true);$("#viewCatRight").load(shoproot+"?/vProduct/ajaxCatList/id="+c+"&serial_id="+serial_id)}function a(){$("#viewCatLeft").height($("#viewCat").height());$("#viewCatRight").height($(window).height()-112)}a()}function fnTouchEnd(a,b){$(a).bind("touchend mouseup",b)}function fnTouchEndRedirect(a){$(a).bind("touchstart mousedown",function(b){$(this).addClass("hover");if(b.originalEvent.touches){b=b.originalEvent.touches[0]}window.touchpoint=b.target});$(a).bind("touchend mouseup",function(b){$(this).removeClass("hover");if(b.originalEvent.touches){b=b.originalEvent.touches[0]}if(b!==undefined){if(b.target===window.touchpoint){if($(this).attr("data-href")){location.href=$(this).attr("data-href");$(this).attr("data-href","")}}}})}function isLogin(){return $.cookie("uid")&&$.cookie("uctoken")}function UcloginLoad(){$("#login-btn").click(function(){if($("#acc").val()!==""&&$("#acc").val()!==""){$.post(shoproot+"?/Uc/AjaxLogin",{account:$("#acc").val(),password:$("#pwd").val()},function(a){if(a==="1"){if($("#referer").val()!==""&&$("#referer").val()!==location.href){location.href=$("#referer").val()}else{location.href=shoproot+"?/Uc/home/"}}else{alert("登陆失败")}})}})}function UcRegLoad(){$("input").eq(0).focus();$("#reg-btn").click(function(){if($("#login-wrap").validate({errorPlacement:function(a,b){b.focus();$(".login-tip").html("请输入"+b.attr("placeholder"))}}).form()){$.post(shoproot+"?/Uc/AjaxReg",{name:$("#nam").val(),password:$("#pwd").val(),email:$("#ema").val(),phone:$("#pho").val(),address:$("#reg").val(),openid:$("#openid").val(),head:$("#head").val(),sex:$("#sex").val()},function(a){switch(a){case"1":alert("注册成功");if($("#referer").val()!==""){location.href=$("#referer").val()}else{location.href=shoproot+"?/Uc/home/"}break;case"2":alert("该手机号已存在");break;case"3":alert("该用户名已存在");break;case"4":alert("该邮箱已存在");break;case"0":alert("注册失败");break}})}})}function edtAddOnload(){$("#addr-add-btn1").click(function(){$("#addr-add").show();$("#addr-select").hide()});$("#addr-add-btn-back").click(function(){$("#addr-add").hide();$("#addr-select").show()});$("#addr-add-btn").click(address_save)}function address_item_click(){$("#wrp-btn").remove();$("#express-name").html($(this).attr("data-name"));$("#express-person-phone").html($(this).attr("data-tel"));$("#express-address").html($(this).attr("data-address"));expressData.userName=$(this).attr("data-name");expressData.telNumber=$(this).attr("data-tel");expressData.addressPostalCode="";expressData.Address=$(this).attr("data-address");addressloaded=true;$("#addrPick").fadeOut()}function address_save(){if($("#dt-name").val()!==""&&$("#dt-address").val()!==""&&$("#dt-tel").val()!==""){$.post(shoproot+"?/Uc/ajaxAddAddress/",{name:$("#dt-name").val(),addr:$("#dt-address").val(),tel:$("#dt-tel").val()},function(a){if(parseInt(a)>0){$("#addr-add").hide();$("#addr-select").show();$("#addr-select").prepend('<div class="addrw" data-id="'+a+'" data-name="'+$("#dt-name").val()+'" data-tel="'+$("#dt-tel").val()+'" data-address="'+$("#dt-address").val()+'"><div class="cot clearfix"><span class="l">'+$("#dt-name").val()+'</span><span class="r">'+$("#dt-tel").val()+'</span></div><div class="add">'+$("#dt-address").val()+"</div></div>");$(".addrw").unbind("click").click(address_item_click)}else{alert("添加失败")}})}}function ComRegLoad(){$("#reg-btn").click(function(){var e=this;if($("#login-wrap").validate({errorPlacement:function(f,g){g.focus();$(".login-tip").html("请输入"+g.attr("placeholder"))}}).form()){var c=$("#set-form-name").val();var a=$("#set-form-phone").val();var d=$("#set-form-id").val();var b=$("#set-form-email").val();if(c!==""&&a!==""&&d!==""){e.innerHTML="提交中";$.post(shoproot+"?/Company/addCompany/",{name:c,phone:a,email:b,ids:d,openid:$("#openid").val()},function(f){if(parseInt(f)===1){alert("您的申请已提交，请耐心等待系统审核。");location.href=shoproot+"?/Uc/"}else{e.innerHTML="提交申请";alert("提交失败")}})}}})}function UcorderLoad(){if($("#uc-orderlist").length>0){window.currentOrderpage=0;window.orderLoading=false;window.orderLoadingLock=false;a(currentOrderpage);$(window).scroll(function(){totalheight=parseFloat($(window).height())+parseFloat($(window).scrollTop())+150;if($(document).height()<=totalheight&&!orderLoading){a(++currentOrderpage)}})}$(".uc-order-sort").unbind("click").click(function(){currentOrderpage=-1;orderLoading=false;orderLoadingLock=false;$("#status").val($(this).attr("data-status"));$(".uc-order-sort.hover").removeClass("hover");$(this).addClass("hover");a(currentOrderpage)});function a(b){if(!orderLoadingLock){b=parseInt(b);if(b===-1){b=0;$("#uc-orderlist").html("")}orderLoading=true;$("#buttomLoading").show();$.get(shoproot+"?/Uc/ajaxOrderlist/page="+b+"&status="+$("#status").val(),function(c){orderLoading=false;if(c===""&&b===0){$("#uc-orderlist").append('<div class="emptyTip">暂无数据</div>')}else{if(c!==""){if(b===0){$("#uc-orderlist").html(c)}else{$("#uc-orderlist").append(c)}}else{orderLoadingLock=true}}$("#buttomLoading").hide()})}}}function UcLikeLoad(){};